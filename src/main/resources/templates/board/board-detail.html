<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
	<th:block th:insert="~{layout/header :: header('Crispy')}"></th:block>
	<link rel="stylesheet" href="/css/summernote/summernote-lite.css">
	<link href="/css/board/board-add.css" rel="stylesheet">
</head>
<body>
<div class="crispy-container">
	<aside th:replace="~{layout/sidebar :: sidebar}"></aside>
	<div>
		<header th:replace="~{layout/navbar :: navbar}"></header>
		<main>
			<div class="main">
				<form id="frm-board-add" action="/crispy/add-form" method="POST" enctype="multipart/form-data" class="my-3">
					<div class="col-md-5">
						<label for="cate" class="form-label">카테고리</label>
						<select class="form-select" id="cate" name="boardCtNo" required>
							<option value="">카테고리</option>
							<option value="0" th:selected="${board.boardCtNo == 0}">공지사항</option>
							<option value="1" th:selected="${board.boardCtNo == 1}">자유게시판</option>
						</select>
					</div>
					<label for="boardTitle" class="form-label">제목</label>
					<input type="text" name="boardTitle" id="boardTitle" th:value="${board.boardTitle}" class="form-control" style="white-space: pre-line;" placeholder="제목은 15자 내외로 입력해주세요." maxlength="15" required />
					<div class="mb-3">
						<label for="summernote" class="form-label mt-2">내용</label>
						<textarea id="summernote" name="boardContent" class="boardContent"></textarea>
					</div>
					<div class="file-attach">
						<!-- board.empNo가 null이면 빈 문자열을, 아니면 해당 값을 설정 -->
						<input type="hidden" name="empNo" th:value="${board.empNo != null ? board.empNo : ''}" />
						<div class="mb-3">
							<input class="form-control" type="file" id="formFileMultiple" name="files" multiple>
							<!-- 여기다 등록된 파일 detail 표시 -->
							<input type="hidden" name="boardOrigin" value="${board.boardOrigin}">
						</div>
					</div>
					<div class="d-flex justify-content-end" id="btn">
						<a id="cancelBtn" class="btn btn-primary btn-lg">삭제</a>
						<button type="submit" id="addBtn" class="btn btn-primary btn-lg">수정</button>
					</div>
				</form>
				<!-- Hidden div to hold boardContent value -->
				<div id="hiddenBoardContent" th:text="${board.boardContent}" style="display:none;"></div>
			</div>
		</main>
		<footer th:replace="~{layout/footer :: footer}"></footer>
	</div>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="/js/summernote/summernote-lite.js"></script>
	<script src="/js/summernote/lang/summernote-ko-KR.js"></script>
	<script>
		$(document).ready(function() {
			// Initialize Summernote
			$('#summernote').summernote({
				placeholder: '500자',
				tabsize: 2,
				height: 400,
				toolbar: [
					['style', ['style']],
					['font', ['bold', 'underline', 'clear']],
					['color', ['color']],
					['para', ['ul', 'ol', 'paragraph']],
					['table', ['table']],
					['insert', ['link', 'picture', 'video']],
					['view', ['fullscreen', 'codeview', 'help']]
				],
				callbacks: {
					onInit: function() {
						$('#summernote').next().find('.note-placeholder').css('font-size', '16px');
						// Set the content from hidden div
						const boardContent = $('#hiddenBoardContent').text();
						$('#summernote').summernote('code', boardContent);
					}
				},
			});
		});

		$('#cancelBtn').on('click', () => {
			window.location.href = "/board/board-list";
		});

		/* $('#frm-board-add').on('submit', function(evt) {
            if ($('#boardTitle').val().trim() === '') {
                alert('제목 입력은 필수입니다.');
                evt.preventDefault();
            } else if ($('#summernote').val().trim() === '') {
                alert('내용 입력은 필수입니다.');
                evt.preventDefault();
            } else {
                alert("게시물이 등록되었습니다.");
                window.location.href = '/crispy/board-detail';
            }
        }); */
	</script>
</div>
</body>
</html>
